import{ref as e,reactive as t,computed as n,watch as r,onMounted as o,onBeforeUnmount as a,openBlock as l,createElementBlock as s,createElementVNode as i,renderSlot as u,createTextVNode as c,createCommentVNode as h,unref as p,Fragment as v,renderList as f,toDisplayString as d}from"vue";function g(e,t,n){return Math.max(t,Math.min(e,n))}function b(e,t=2){return e.toFixed(t).replace(/\.?0+$/,"")}function m(e){if(e.endsWith("."))return NaN;return(parseFloat(e)%360+360)%360/360}function y(e){return b(360*e)}function w(e){if(!e.endsWith("%"))return NaN;const t=e.substring(0,e.length-1);if(t.endsWith("."))return NaN;const n=parseFloat(t);return Number.isNaN(n)?NaN:g(n,0,100)/100}function x(e){return b(100*e)+"%"}function $(e){if(e.endsWith("%"))return w(e);if(e.endsWith("."))return NaN;const t=parseFloat(e);return Number.isNaN(t)?NaN:g(t,0,255)/255}function k(e){return b(255*e)}function C(e){return e.endsWith("%")?w(e):g(parseFloat(e),0,1)}function N(e){return String(e)}const M={hsl:{h:{to:y,from:m},s:{to:x,from:w},l:{to:x,from:w},a:{to:N,from:C}},hwb:{h:{to:y,from:m},w:{to:x,from:w},b:{to:x,from:w},a:{to:N,from:C}},rgb:{r:{to:k,from:$},g:{to:k,from:$},b:{to:k,from:$},a:{to:N,from:C}}};function F(e){const t=e.replace(/^#/,""),n=[],r=t.length>4?2:1;for(let e=0;e<t.length;e+=r){const o=t.slice(e,e+r);n.push(o.repeat(r%2+1))}3===n.length&&n.push("ff");const o=n.map((e=>parseInt(e,16)/255));return{r:o[0],g:o[1],b:o[2],a:o[3]}}function A(e){const t=e.l<.5?e.l*(1+e.s):e.l+e.s-e.l*e.s,n=2*e.l-t;return{r:L(n,t,e.h+1/3),g:L(n,t,e.h),b:L(n,t,e.h-1/3),a:e.a}}function L(e,t,n){return n<0?n+=1:n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function S(e){return{r:E(5,e),g:E(3,e),b:E(1,e),a:e.a}}function E(e,t){const n=(e+6*t.h)%6;return t.v-t.v*t.s*Math.max(0,Math.min(n,4-n,1))}function I(e){return{h:e.h,s:1===e.b?0:1-e.w/(1-e.b),v:1-e.b,a:e.a}}function P(e){const t=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b);let r;return r=n===t?0:n===e.r?(0+(e.g-e.b)/(n-t))/6:n===e.g?(2+(e.b-e.r)/(n-t))/6:(4+(e.r-e.g)/(n-t))/6,r<0&&(r+=1),{h:r,w:t,b:1-n,a:e.a}}function O(e){const t=P(e),n=t.w,r=1-t.b,o=(r+n)/2;let a;return a=0===r||1===n?0:(r-o)/Math.min(o,1-o),{h:t.h,s:a,l:o,a:e.a}}function T(e){return"#"+Object.values(e).map((e=>{const t=255*e,n=Math.round(t).toString(16);return 1===n.length?"0"+n:n})).join("")}const j={hex:[["hsl",e=>H(e,[F,O])],["hsv",e=>H(e,[F,P,I])],["hwb",e=>H(e,[F,P])],["rgb",F]],hsl:[["hex",e=>H(e,[A,T])],["hsv",function(e){const t=e.l+e.s*Math.min(e.l,1-e.l),n=0===t?0:2-2*e.l/t;return{h:e.h,s:n,v:t,a:e.a}}],["hwb",e=>H(e,[A,P])],["rgb",A]],hsv:[["hex",e=>H(e,[S,T])],["hsl",function(e){const t=e.v-e.v*e.s/2,n=Math.min(t,1-t),r=0===n?0:(e.v-t)/n;return{h:e.h,s:r,l:t,a:e.a}}],["hwb",function(e){return{h:e.h,w:(1-e.s)*e.v,b:1-e.v,a:e.a}}],["rgb",S]],hwb:[["hex",e=>H(e,[I,S,T])],["hsl",e=>H(e,[I,S,O])],["hsv",I],["rgb",e=>H(e,[I,S])]],rgb:[["hex",T],["hsl",O],["hsv",e=>H(e,[P,I])],["hwb",P]]};function H(e,t){return t.reduce(((e,t)=>t(e)),e)}function _(e){const t={};for(const n in e)t[n]=e[n];return t}const z={hex:(e,t)=>t&&[5,9].includes(e.length)?e.substring(0,e.length-(e.length-1)/4):e,hsl:(e,t)=>`hsl(${b(360*e.h)} ${b(100*e.s)}% ${b(100*e.l)}%`+(t?")":` / ${b(e.a)})`),hwb:(e,t)=>`hwb(${b(360*e.h)} ${b(100*e.w)}% ${b(100*e.b)}%`+(t?")":` / ${b(e.a)})`),rgb:(e,t)=>`rgb(${b(255*e.r)} ${b(255*e.g)} ${b(255*e.b)}`+(t?")":` / ${b(e.a)})`)};function D(e,t,n){return z[t](e,n)}function W(e){return/^#(?:(?:[A-F0-9]{2}){3,4}|[A-F0-9]{3,4})$/i.test(e)}function q(e){if("string"!=typeof e){const t=function(e){return Object.prototype.hasOwnProperty.call(e,"r")?"rgb":Object.prototype.hasOwnProperty.call(e,"w")?"hwb":Object.prototype.hasOwnProperty.call(e,"v")?"hsv":"hsl"}(e);return{format:t,color:e}}if(W(e))return{format:"hex",color:e};if(!e.includes("(")){const t=document.createElement("canvas").getContext("2d");t.fillStyle=e;const n=t.fillStyle;return"#000000"===n&&"black"!==e?null:{format:"hex",color:n}}const[t,n]=e.split("("),r=t.substring(0,3),o=n.replace(/[,/)]/g," ").replace(/\s+/g," ").trim().split(" ");3===o.length&&o.push("1");const a=r.split("").concat("a"),l=Object.fromEntries(a.map(((e,t)=>[e,M[r][e].from(o[t])])));return{format:r,color:l}}const K=["hex","hsl","hwb","rgb"],R=["show","hide"],U={class:"vacp-range-input-group"},B=["for"],X={class:"vacp-range-input-label-text vacp-range-input-label-text--hue"},Y=["id","value"],G=["for"],J={class:"vacp-range-input-label-text vacp-range-input-label-text--alpha"},Q=["id","value"],V=i("span",{class:"vacp-visually-hidden"},"Copy color",-1),Z=i("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",width:"24",height:"24",viewBox:"0 0 32 32"},[i("path",{d:"M25.313 28v-18.688h-14.625v18.688h14.625zM25.313 6.688c1.438 0 2.688 1.188 2.688 2.625v18.688c0 1.438-1.25 2.688-2.688 2.688h-14.625c-1.438 0-2.688-1.25-2.688-2.688v-18.688c0-1.438 1.25-2.625 2.688-2.625h14.625zM21.313 1.313v2.688h-16v18.688h-2.625v-18.688c0-1.438 1.188-2.688 2.625-2.688h16z",fill:"currentColor"})],-1),ee={class:"vacp-color-inputs"},te={class:"vacp-color-input-group"},ne=["for"],re=i("span",{class:"vacp-color-input-label-text"}," Hex ",-1),oe=["id","value"],ae=["id","for","onInput"],le={class:"vacp-color-input-label-text"},se=["id","value","onInput"],ie=i("span",{class:"vacp-visually-hidden"},"Switch format",-1),ue=i("svg",{class:"vacp-icon","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"15"},[i("path",{d:"M8 15l5-5-1-1-4 2-4-2-1 1zm4-9l1-1-5-5-5 5 1 1 4-2z",fill:"currentColor"})],-1);var ce={__name:"ColorPicker",props:{color:{type:[String,Object],required:!1,default:"#ffffffff"},id:{type:String,required:!1,default:"color-picker"},visibleFormats:{type:Array,required:!1,default:()=>K,validator:e=>e.length>0&&e.every((e=>K.includes(e)))},defaultFormat:{type:String,required:!1,default:"hsl",validator:e=>K.includes(e)},alphaChannel:{type:String,required:!1,default:"show",validator:e=>R.includes(e)}},emits:["color-change"],setup(b,{emit:m}){const y=b,w=e(null),x=e(null),$=e(null),k=e(!1),C=e(y.visibleFormats.includes(y.defaultFormat)?y.defaultFormat:y.visibleFormats[0]),N=t({hex:"#ffffffff",hsl:{h:0,s:0,l:1,a:1},hsv:{h:0,s:0,v:1,a:1},hwb:{h:0,w:1,b:0,a:1},rgb:{r:1,g:1,b:1,a:1}}),F=n((function(){const e=Object.keys(N[C.value]);return"hex"!==C.value&&"hide"===y.alphaChannel?e.slice(0,3):e})),A=n((function(){return"hide"===y.alphaChannel&&[5,9].includes(N.hex.length)?N.hex.substring(0,N.hex.length-(N.hex.length-1)/4):N.hex}));function L(){const e=(y.visibleFormats.findIndex((e=>e===C.value))+1)%y.visibleFormats.length;C.value=y.visibleFormats[e]}function S(e){k.value=!0,P(e)}function E(e){k.value=!0,O(e)}function I(){k.value=!1}function P(e){1===e.buttons&&!1!==k.value&&x.value instanceof HTMLElement&&T(x.value,e.clientX,e.clientY)}function O(e){if(!1===k.value||!(x.value instanceof HTMLElement))return;e.preventDefault();const t=e.touches[0];T(x.value,t.clientX,t.clientY)}function T(e,t,n){const r=function(e,t,n){const r=e.getBoundingClientRect(),o=t-r.left,a=n-r.top;return{x:g(o/r.width,0,1),y:g(1-a/r.height,0,1)}}(e,t,n),o=_(N.hsv);o.s=r.x,o.v=r.y,he("hsv",o)}function H(e){if(!["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(e.key))return;e.preventDefault();const t=["ArrowLeft","ArrowDown"].includes(e.key)?-1:1,n=["ArrowLeft","ArrowRight"].includes(e.key)?"s":"v",r=e.shiftKey?10:1,o=N.hsv[n]+t*r*.01,a=_(N.hsv);a[n]=g(o,0,1),he("hsv",a)}function z(e){const t=q(e);null!==t&&he(t.format,t.color)}function K(e,t){const n=e.currentTarget,r=_(N.hsv);r[t]=parseInt(n.value)/parseInt(n.max),he("hsv",r)}function R(e){const t=e.target;W(t.value)&&he("hex",t.value)}function ce(e,t){const n=e.target,r=_(N[C.value]),o=M[C.value][t].from(n.value);Number.isNaN(o)||void 0===o||(r[t]=o,he(C.value,r))}function he(e,t){let n=t;if("hide"===y.alphaChannel)if("string"!=typeof t)t.a=1,n=t;else if([5,9].includes(t.length)){const e=(t.length-1)/4;n=t.substring(0,t.length-e)+"f".repeat(e)}else[4,7].includes(t.length)&&(n=t+"f".repeat((t.length-1)/3));if(!function(e,t){if("string"==typeof e||"string"==typeof t)return e===t;for(const n in e)if(e[n]!==t[n])return!1;return!0}(N[e],n)){!function(e,t){N[e]=t;for(const[t,n]of j[e])N[t]=n(N[e])}(e,n);const t=function(){const e="hide"===y.alphaChannel,t=D(N[C.value],C.value,e);return{colors:N,cssColor:t}}();m("color-change",t)}!function(){if(!(w.value instanceof HTMLElement&&x.value instanceof HTMLElement&&$.value instanceof HTMLElement))return;w.value.style.setProperty("--vacp-hsl-h",String(N.hsl.h)),w.value.style.setProperty("--vacp-hsl-s",String(N.hsl.s)),w.value.style.setProperty("--vacp-hsl-l",String(N.hsl.l)),w.value.style.setProperty("--vacp-hsl-a",String(N.hsl.a)),x.value.style.position="relative",x.value.style.backgroundColor="hsl(calc(var(--vacp-hsl-h) * 360) 100% 50%)",x.value.style.backgroundImage="linear-gradient(to top, #000, transparent), linear-gradient(to right, #fff, transparent)",$.value.style.boxSizing="border-box",$.value.style.position="absolute",$.value.style.left=100*N.hsv.s+"%",$.value.style.bottom=100*N.hsv.v+"%"}()}async function pe(){const e=N[C.value],t="hide"===y.alphaChannel,n=D(e,C.value,t);await window.navigator.clipboard.writeText(n)}function ve(e,t){return M[e][t].to(N[e][t])}function fe(e){if(!["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(e.key)||!e.shiftKey)return;const t=e.currentTarget,n=parseFloat(t.step),r=["ArrowLeft","ArrowDown"].includes(e.key)?-1:1,o=g(parseFloat(t.value)+r*n*10,parseInt(t.min),parseInt(t.max));t.value=String(o-r*n)}return r((()=>y.color),z),o((function(){document.addEventListener("mousemove",P,{passive:!1}),document.addEventListener("touchmove",O,{passive:!1}),document.addEventListener("mouseup",I),document.addEventListener("touchend",I),z(y.color)})),a((function(){document.removeEventListener("mousemove",P),document.removeEventListener("touchmove",O),document.removeEventListener("mouseup",I),document.removeEventListener("touchend",I)})),(e,t)=>(l(),s("div",{ref_key:"colorPicker",ref:w,class:"vacp-color-picker"},[i("div",{ref_key:"colorSpace",ref:x,class:"vacp-color-space",onMousedown:S,onTouchstart:E},[i("div",{ref_key:"thumb",ref:$,class:"vacp-color-space-thumb",tabindex:"0","aria-label":"Color space thumb",onKeydown:H},null,544)],544),i("div",U,[i("label",{class:"vacp-range-input-label vacp-range-input-label--hue",for:`${b.id}-hue-slider`},[i("span",X,[u(e.$slots,"hue-range-input-label",{},(()=>[c("Hue")]))]),i("input",{id:`${b.id}-hue-slider`,class:"vacp-range-input vacp-range-input--hue",value:360*N.hsv.h,type:"range",min:"0",max:"360",step:"1",onKeydownPassive:fe,onInput:t[0]||(t[0]=e=>K(e,"h"))},null,40,Y)],8,B),"show"===b.alphaChannel?(l(),s("label",{key:0,class:"vacp-range-input-label vacp-range-input-label--alpha",for:`${b.id}-alpha-slider`},[i("span",J,[u(e.$slots,"alpha-range-input-label",{},(()=>[c("Alpha")]))]),i("input",{id:`${b.id}-alpha-slider`,class:"vacp-range-input vacp-range-input--alpha",value:100*N.hsv.a,type:"range",min:"0",max:"100",step:"1",onKeydownPassive:fe,onInput:t[1]||(t[1]=e=>K(e,"a"))},null,40,Q)],8,G)):h("v-if",!0)]),i("button",{class:"vacp-copy-button",type:"button",onClick:pe},[u(e.$slots,"copy-button",{},(()=>[V,Z]))]),i("div",ee,[i("div",te,["hex"===C.value?(l(),s("label",{key:0,class:"vacp-color-input-label",for:`${b.id}-color-hex`},[re,i("input",{id:`${b.id}-color-hex`,class:"vacp-color-input",type:"text",value:p(A),onInput:R},null,40,oe)],8,ne)):(l(!0),s(v,{key:1},f(p(F),(e=>(l(),s("label",{id:`${b.id}-color-${C.value}-${e}`,key:`${b.id}-color-${C.value}-${e}`,class:"vacp-color-input-label",for:`${b.id}-color-${C.value}`,onInput:t=>ce(t,e)},[i("span",le,d(e.toUpperCase()),1),i("input",{id:`${b.id}-color-${C.value}`,class:"vacp-color-input",type:"text",value:ve(C.value,e),onInput:t=>ce(t,e)},null,40,se)],40,ae)))),128))]),b.visibleFormats.length>1?(l(),s("button",{key:0,class:"vacp-format-switch-button",type:"button",onClick:L},[u(e.$slots,"format-switch-button",{},(()=>[ie,ue]))])):h("v-if",!0)])],512))},__file:"src/ColorPicker.vue"};const he={install(e){e.component("ColorPicker",ce)}};export{ce as ColorPicker,he as default};
